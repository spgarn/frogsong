{"version":3,"file":"ucare-panel-chunk-4a2d283a366f71da6178.js","mappings":"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","sources":["webpack://gatsby-starter-hello-world/./node_modules/@uploadcare/react-widget/dist/esm/default-preview-url-callback-23ab7c4e.mjs","webpack://gatsby-starter-hello-world/./node_modules/@uploadcare/react-widget/dist/esm/dialog-f9012e19.mjs"],"sourcesContent":["import { useRef, useEffect, useCallback } from 'react';\nimport { b as _slicedToArray } from './index-da2efec7.mjs';\nimport isEqual from 'react-fast-compare';\n\nvar useCommitedRef = function useCommitedRef(value) {\n  var ref = useRef(value);\n  useEffect(function () {\n    ref.current = value;\n  }, [value]);\n  return ref;\n};\n\nvar useCommitedCallback = function useCommitedCallback(callback) {\n  var ref = useCommitedRef(callback);\n  return useCallback(function () {\n    return ref.current && ref.current.apply(ref, arguments);\n  }, [ref]);\n};\n\nvar useDeepEffect = function useDeepEffect(effect, deps) {\n  var ref = useRef(undefined);\n  if (!isEqual(deps, ref.current)) {\n    ref.current = deps;\n  }\n\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  useEffect(effect, ref.current);\n};\n\nvar useCustomTabs = function useCustomTabs(tabs, uploadcare) {\n  useDeepEffect(function () {\n    var customTabs = Object.entries(tabs || []);\n    customTabs.forEach(function (_ref) {\n      var _ref2 = _slicedToArray(_ref, 2),\n        name = _ref2[0],\n        implementation = _ref2[1];\n      uploadcare.registerTab(name, function () {\n        for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n          args[_key] = arguments[_key];\n        }\n        return implementation.apply(void 0, args.concat([uploadcare]));\n      });\n    });\n  }, [tabs, uploadcare]);\n};\n\nvar defaultPreviewUrlCallback = function defaultPreviewUrlCallback(cdnUrl) {\n  return cdnUrl;\n};\n\nexport { useCustomTabs as a, useDeepEffect as b, defaultPreviewUrlCallback as d, useCommitedCallback as u };\n","import { b as _slicedToArray, _ as _objectWithoutProperties, a as _objectSpread2, c as _toConsumableArray, d as _createForOfIteratorHelper } from './index-da2efec7.mjs';\nimport React, { useState, useMemo, useRef, useEffect, useImperativeHandle } from 'react';\nimport uploadcare from 'uploadcare-widget';\nimport { u as useCommitedCallback, a as useCustomTabs, b as useDeepEffect, d as defaultPreviewUrlCallback } from './default-preview-url-callback-23ab7c4e.mjs';\nimport 'react-fast-compare';\n\nvar _excluded = [\"value\", \"apiRef\", \"onTabChange\", \"onChange\", \"onProgress\", \"customTabs\", \"previewUrlCallback\", \"metadataCallback\"];\nvar containerStyles = {\n  height: '500px',\n  display: 'flex',\n  flexDirection: 'column',\n  alignItems: 'center',\n  justifyContent: 'center'\n};\nvar getHiddenDoneButtonStyle = function getHiddenDoneButtonStyle(containerId) {\n  return (/* css */\"\\n  .\".concat(containerId, \" .uploadcare--preview__done:not(.uploadcare-tab-effects--done),\\n  .\").concat(containerId, \" .uploadcare--panel__done:not(.uploadcare-tab-effects--done) {\\n    display: none;\\n  }\\n\")\n  );\n};\nvar getValueItems = function getValueItems(value, props) {\n  var uuids = [];\n  if (value) {\n    uuids = Array.isArray(value) ? value : [value];\n  }\n  return uuids;\n};\nvar useDialog = function useDialog(props, uploadcare) {\n  var value = props.value,\n    apiRef = props.apiRef,\n    onTabChange = props.onTabChange,\n    onChange = props.onChange,\n    onProgress = props.onProgress,\n    customTabs = props.customTabs,\n    previewUrlCallback = props.previewUrlCallback,\n    metadataCallback = props.metadataCallback,\n    restProps = _objectWithoutProperties(props, _excluded);\n  var tabsCss = restProps.tabsCss,\n    locale = restProps.locale,\n    localeTranslations = restProps.localeTranslations,\n    localePluralize = restProps.localePluralize;\n  var panelContainer = useRef(null);\n  var panelInstance = useRef(null);\n  var onTabChangeCallback = useCommitedCallback(onTabChange);\n  var onChangeCallback = useCommitedCallback(onChange);\n  var onProgressCallback = useCommitedCallback(onProgress);\n  var metadataCommitedCallback = useCommitedCallback(metadataCallback);\n  var previewUrlCommitedCallback = useCommitedCallback(previewUrlCallback || defaultPreviewUrlCallback);\n  useCustomTabs(customTabs, uploadcare);\n  useDeepEffect(function () {\n    if (locale) window.UPLOADCARE_LOCALE = locale;\n    if (localePluralize) window.UPLOADCARE_LOCALE_PLURALIZE = localePluralize;\n    if (localeTranslations) {\n      window.UPLOADCARE_LOCALE_TRANSLATIONS = localeTranslations;\n    }\n    return function () {\n      if (locale) delete window.UPLOADCARE_LOCALE;\n      if (localePluralize) delete window.UPLOADCARE_LOCALE_PLURALIZE;\n      if (localeTranslations) delete window.UPLOADCARE_LOCALE_TRANSLATIONS;\n    };\n  }, [locale, localePluralize, localeTranslations]);\n  useEffect(function () {\n    if (uploadcare && tabsCss && typeof tabsCss === 'string') {\n      if (tabsCss.indexOf('https://') === 0) {\n        uploadcare.tabsCss.addUrl(tabsCss);\n      } else {\n        uploadcare.tabsCss.addStyle(tabsCss);\n      }\n    }\n  }, [uploadcare, tabsCss]);\n  useEffect(function () {\n    var files = getValueItems(value);\n    panelInstance.current && panelInstance.current.reject();\n    panelInstance.current = uploadcare.openPanel(panelContainer.current, files, _objectSpread2(_objectSpread2({\n      multipleMax: restProps.multiple ? undefined : 1\n    }, restProps), {}, {\n      multiple: true,\n      metadataCallback: restProps.metadata ? undefined : metadataCommitedCallback,\n      previewUrlCallback: previewUrlCommitedCallback\n    }));\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [uploadcare].concat(_toConsumableArray(Object.values(restProps))));\n  useEffect(function () {\n    var dialogApi = panelInstance.current;\n    dialogApi.progress(onTabChangeCallback);\n    var onChangeWrapper = function onChangeWrapper() {\n      var items = panelInstance.current.fileColl.__items.map(function (deferred) {\n        return deferred.promise();\n      });\n      onChangeCallback(items);\n    };\n    var onProgressWrapper = function onProgressWrapper() {\n      var lastProgresses = panelInstance.current.fileColl.lastProgresses();\n      onProgressCallback(lastProgresses);\n    };\n    dialogApi.fileColl.anyProgressList.add(onProgressWrapper);\n    dialogApi.fileColl.anyDoneList.add(onChangeWrapper);\n    dialogApi.fileColl.anyFailList.add(onChangeWrapper);\n    dialogApi.fileColl.onRemove.add(onChangeWrapper);\n    dialogApi.fileColl.onReplace.add(onChangeWrapper);\n    dialogApi.fileColl.onSort.add(onChangeWrapper);\n    return function () {\n      var dialogApi = panelInstance.current;\n      dialogApi.fileColl.anyProgressList.remove(onProgressWrapper);\n      dialogApi.fileColl.anyDoneList.remove(onChangeWrapper);\n      dialogApi.fileColl.anyFailList.remove(onChangeWrapper);\n      dialogApi.fileColl.onRemove.remove(onChangeWrapper);\n      dialogApi.fileColl.onReplace.remove(onChangeWrapper);\n      dialogApi.fileColl.onSort.remove(onChangeWrapper);\n    };\n  }, [].concat(_toConsumableArray(Object.values(restProps)), [onTabChangeCallback, onChangeCallback, onProgressCallback]));\n  useImperativeHandle(apiRef, function () {\n    return {\n      onTabVisibility: function onTabVisibility(cb) {\n        return panelInstance.current.onTabVisibility(cb);\n      },\n      hideTab: function hideTab(tab) {\n        return panelInstance.current.hideTab(tab);\n      },\n      showTab: function showTab(tab) {\n        return panelInstance.current.showTab(tab);\n      },\n      switchTab: function switchTab(tab) {\n        return panelInstance.current.switchTab(tab);\n      },\n      addFiles: function addFiles(files) {\n        return panelInstance.current.addFiles(files);\n      },\n      isTabVisible: function isTabVisible(tab) {\n        return panelInstance.current.isTabVisible(tab);\n      },\n      getFileColl: function getFileColl() {\n        return panelInstance.current.fileColl;\n      },\n      getRawDialogApi: function getRawDialogApi() {\n        return panelInstance.current;\n      }\n    };\n  }, []);\n  useEffect(function () {\n    return function () {\n      return panelInstance.current && panelInstance.current.reject();\n    };\n  }, []);\n  useEffect(function () {\n    var isUpdated = false;\n    panelInstance.current.fileColl.clear();\n    var files = getValueItems(value);\n    var _iterator = _createForOfIteratorHelper(files),\n      _step;\n    try {\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        var item = _step.value;\n        if (typeof item === 'string' && item.includes('~')) {\n          uploadcare.loadFileGroup(item, props).then(function (fileGroup) {\n            // value could be changed after group loaded\n            if (!isUpdated) {\n              var _files = fileGroup.files();\n              panelInstance.current.addFiles(_files);\n            }\n          });\n          break;\n        }\n        panelInstance.current.fileColl.add(uploadcare.fileFrom('uploaded', item, props));\n      }\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n    return function () {\n      isUpdated = true;\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [value]);\n  return [panelContainer];\n};\nvar Dialog = function Dialog(props) {\n  var _useState = useState(function () {\n      return \"uploadcare-\".concat(Date.now());\n    }),\n    _useState2 = _slicedToArray(_useState, 1),\n    containerId = _useState2[0];\n  var styleElement = useMemo(function () {\n    return /*#__PURE__*/React.createElement(\"style\", null, getHiddenDoneButtonStyle(containerId));\n  }, [containerId]);\n  var _useDialog = useDialog(props, uploadcare),\n    _useDialog2 = _slicedToArray(_useDialog, 1),\n    containerRef = _useDialog2[0];\n  return /*#__PURE__*/React.createElement(\"div\", {\n    id: props.id,\n    className: containerId,\n    style: containerStyles\n  }, styleElement, /*#__PURE__*/React.createElement(\"div\", {\n    ref: containerRef\n  }));\n};\n\nexport { Dialog as default };\n"],"names":["useCommitedCallback","callback","ref","value","useRef","useEffect","current","useCommitedRef","useCallback","apply","arguments","useDeepEffect","effect","deps","undefined","useCustomTabs","tabs","uploadcare","Object","entries","forEach","_ref","_ref2","name","implementation","registerTab","_len","length","args","Array","_key","concat","defaultPreviewUrlCallback","cdnUrl","_excluded","containerStyles","height","display","flexDirection","alignItems","justifyContent","getValueItems","props","uuids","isArray","Dialog","_useState","useState","Date","now","containerId","styleElement","useMemo","getHiddenDoneButtonStyle","_useDialog","apiRef","onTabChange","onChange","onProgress","customTabs","previewUrlCallback","metadataCallback","restProps","_","tabsCss","locale","localeTranslations","localePluralize","panelContainer","panelInstance","onTabChangeCallback","u","onChangeCallback","onProgressCallback","metadataCommitedCallback","previewUrlCommitedCallback","d","window","UPLOADCARE_LOCALE","UPLOADCARE_LOCALE_PLURALIZE","UPLOADCARE_LOCALE_TRANSLATIONS","indexOf","addUrl","addStyle","files","reject","openPanel","multipleMax","multiple","metadata","values","dialogApi","progress","onChangeWrapper","items","fileColl","__items","map","deferred","promise","onProgressWrapper","lastProgresses","anyProgressList","add","anyDoneList","anyFailList","onRemove","onReplace","onSort","remove","useImperativeHandle","onTabVisibility","cb","hideTab","tab","showTab","switchTab","addFiles","isTabVisible","getFileColl","getRawDialogApi","isUpdated","clear","_step","_iterator","s","n","done","item","includes","loadFileGroup","then","fileGroup","_files","fileFrom","err","e","f","useDialog","containerRef","id","className","style"],"sourceRoot":""}