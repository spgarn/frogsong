{"version":3,"file":"ucare-widget-chunk-3ec93d80cb31609ee34c.js","mappings":"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","sources":["webpack://gatsby-starter-hello-world/./node_modules/@uploadcare/react-widget/dist/esm/default-preview-url-callback-23ab7c4e.mjs","webpack://gatsby-starter-hello-world/./node_modules/@uploadcare/react-widget/dist/esm/uploader-fd825cd7.mjs"],"sourcesContent":["import { useRef, useEffect, useCallback } from 'react';\nimport { b as _slicedToArray } from './index-da2efec7.mjs';\nimport isEqual from 'react-fast-compare';\n\nvar useCommitedRef = function useCommitedRef(value) {\n  var ref = useRef(value);\n  useEffect(function () {\n    ref.current = value;\n  }, [value]);\n  return ref;\n};\n\nvar useCommitedCallback = function useCommitedCallback(callback) {\n  var ref = useCommitedRef(callback);\n  return useCallback(function () {\n    return ref.current && ref.current.apply(ref, arguments);\n  }, [ref]);\n};\n\nvar useDeepEffect = function useDeepEffect(effect, deps) {\n  var ref = useRef(undefined);\n  if (!isEqual(deps, ref.current)) {\n    ref.current = deps;\n  }\n\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  useEffect(effect, ref.current);\n};\n\nvar useCustomTabs = function useCustomTabs(tabs, uploadcare) {\n  useDeepEffect(function () {\n    var customTabs = Object.entries(tabs || []);\n    customTabs.forEach(function (_ref) {\n      var _ref2 = _slicedToArray(_ref, 2),\n        name = _ref2[0],\n        implementation = _ref2[1];\n      uploadcare.registerTab(name, function () {\n        for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n          args[_key] = arguments[_key];\n        }\n        return implementation.apply(void 0, args.concat([uploadcare]));\n      });\n    });\n  }, [tabs, uploadcare]);\n};\n\nvar defaultPreviewUrlCallback = function defaultPreviewUrlCallback(cdnUrl) {\n  return cdnUrl;\n};\n\nexport { useCustomTabs as a, useDeepEffect as b, defaultPreviewUrlCallback as d, useCommitedCallback as u };\n","import { _ as _objectWithoutProperties, a as _objectSpread2 } from './index-da2efec7.mjs';\nimport React, { useEffect, useRef, useImperativeHandle, useCallback } from 'react';\nimport uploadcare from 'uploadcare-widget';\nimport { u as useCommitedCallback, a as useCustomTabs, b as useDeepEffect, d as defaultPreviewUrlCallback } from './default-preview-url-callback-23ab7c4e.mjs';\nimport isEqual from 'react-fast-compare';\n\nvar useValidators = function useValidators(widget, validators) {\n  useEffect(function () {\n    if (validators != null) {\n      var instance = widget.current;\n      validators.forEach(function (validator) {\n        instance.validators.push(validator);\n      });\n      return function () {\n        instance.validators.length = 0;\n      };\n    }\n  }, [widget, validators]);\n};\n\nfunction useDeepMemo(factory, deps) {\n  var isValid = true;\n  var valueRef = useRef();\n  // initial hook call\n  if (!valueRef.current) {\n    valueRef.current = {\n      deps: deps,\n      result: factory()\n    };\n    // subsequent calls\n  } else {\n    isValid = !!(deps && valueRef.current.deps && isEqual(deps, valueRef.current.deps));\n  }\n  var cache = isValid ? valueRef.current : {\n    deps: deps,\n    result: factory()\n  };\n  // must update immediately so any sync renders here don't cause an infinite loop\n  valueRef.current = cache;\n  return cache.result;\n}\n\nvar _excluded = [\"id\", \"name\", \"value\", \"onFileSelect\", \"onChange\", \"onDialogOpen\", \"onDialogClose\", \"onTabChange\", \"apiRef\", \"customTabs\", \"validators\", \"tabsCss\", \"locale\", \"localeTranslations\", \"localePluralize\", \"previewUrlCallback\", \"metadataCallback\"];\nvar useWidget = function useWidget(_ref, uploadcare) {\n  var id = _ref.id,\n    name = _ref.name,\n    value = _ref.value,\n    onFileSelect = _ref.onFileSelect,\n    onChange = _ref.onChange,\n    onDialogOpen = _ref.onDialogOpen,\n    onDialogClose = _ref.onDialogClose,\n    onTabChange = _ref.onTabChange,\n    apiRef = _ref.apiRef,\n    customTabs = _ref.customTabs,\n    validators = _ref.validators,\n    tabsCss = _ref.tabsCss,\n    locale = _ref.locale,\n    localeTranslations = _ref.localeTranslations,\n    localePluralize = _ref.localePluralize,\n    previewUrlCallback = _ref.previewUrlCallback,\n    metadataCallback = _ref.metadataCallback,\n    options = _objectWithoutProperties(_ref, _excluded);\n  var input = useRef(null);\n  var widget = useRef(null);\n  var cachedValueRef = useRef(null);\n  var fileSelectedCallback = useCommitedCallback(onFileSelect);\n  var changeCallback = useCommitedCallback(onChange);\n  var dialogOpenCallback = useCommitedCallback(onDialogOpen);\n  var dialogCloseCallback = useCommitedCallback(onDialogClose);\n  var tabChangeCallback = useCommitedCallback(onTabChange);\n  var metadataCommitedCallback = useCommitedCallback(metadataCallback);\n  var previewUrlCommitedCallback = useCommitedCallback(previewUrlCallback || defaultPreviewUrlCallback);\n  var widgetOptions = useDeepMemo(function () {\n    return options;\n  }, [options]);\n  useCustomTabs(customTabs, uploadcare);\n  useDeepEffect(function () {\n    if (locale) window.UPLOADCARE_LOCALE = locale;\n    if (localePluralize) window.UPLOADCARE_LOCALE_PLURALIZE = localePluralize;\n    if (localeTranslations) {\n      window.UPLOADCARE_LOCALE_TRANSLATIONS = localeTranslations;\n    }\n    uploadcare.plugin(function (internal) {\n      internal.locale.rebuild({\n        locale: locale || null,\n        localeTranslations: localeTranslations || null,\n        localePluralize: localePluralize || null\n      });\n    });\n    return function () {\n      if (locale) delete window.UPLOADCARE_LOCALE;\n      if (localePluralize) delete window.UPLOADCARE_LOCALE_PLURALIZE;\n      if (localeTranslations) delete window.UPLOADCARE_LOCALE_TRANSLATIONS;\n    };\n  }, [locale, localeTranslations, localePluralize]);\n  useEffect(function () {\n    var inputEl = input.current;\n    widget.current = uploadcare.Widget(inputEl, _objectSpread2(_objectSpread2({}, widgetOptions), {}, {\n      metadataCallback: widgetOptions.metadata ? undefined : metadataCommitedCallback,\n      previewUrlCallback: previewUrlCommitedCallback\n    }));\n    var widgetElement = inputEl.nextSibling;\n    if (cachedValueRef.current) {\n      // restore widget value when called twice in React.StrictMode\n      widget.current.value(cachedValueRef.current);\n    }\n    return function () {\n      // useEffect could be called twice inside React.StrictMode\n      // to reinitialize widget on the same input element, we need to cleanup bounded jquery data on it\n      // `uploadcareWidget` is a data attr that is used to store widget api\n      // see https://github.com/uploadcare/uploadcare-widget/blob/feat/unsplash-tab/src/widget/live.js#L11\n      uploadcare.jQuery(inputEl).removeData('uploadcareWidget');\n      widgetElement && widgetElement.remove();\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [uploadcare, widgetOptions, metadataCommitedCallback, previewUrlCommitedCallback]);\n  useValidators(widget, validators);\n  useEffect(function () {\n    widget.current.onUploadComplete.add(changeCallback);\n    widget.current.onChange.add(fileSelectedCallback);\n    return function () {\n      widget.current.onUploadComplete.remove(changeCallback);\n      widget.current.onChange.remove(fileSelectedCallback);\n    };\n  }, [changeCallback, fileSelectedCallback, uploadcare, widgetOptions]);\n  useEffect(function () {\n    var dialog;\n    var saveDialog = function saveDialog(ref) {\n      dialog = ref;\n      dialog.done(dialogCloseCallback).fail(dialogCloseCallback).progress(tabChangeCallback);\n      dialogOpenCallback(ref);\n    };\n    widget.current.onDialogOpen.add(saveDialog);\n    return function () {\n      widget.current.onDialogOpen.remove(saveDialog);\n      dialog && dialog.reject();\n    };\n  }, [dialogCloseCallback, dialogOpenCallback, tabChangeCallback, widgetOptions]);\n  useEffect(function () {\n    var files = [];\n    var saveFiles = function saveFiles(file) {\n      if (file) {\n        files = file.files ? file.files() : [file];\n      } else {\n        files = [];\n      }\n    };\n    widget.current.onChange.add(saveFiles);\n    return function () {\n      files.forEach(function (file) {\n        return file.cancel();\n      });\n      widget.current.onChange.remove(saveFiles);\n    };\n  }, [widgetOptions]);\n  useEffect(function () {\n    if (cachedValueRef.current !== value) {\n      widget.current.value(value);\n    }\n    cachedValueRef.current = value;\n  }, [value]);\n  useEffect(function () {\n    if (uploadcare && tabsCss && typeof tabsCss === 'string') {\n      if (tabsCss.indexOf('https://') === 0) {\n        uploadcare.tabsCss.addUrl(tabsCss);\n      } else {\n        uploadcare.tabsCss.addStyle(tabsCss);\n      }\n    }\n  }, [uploadcare, tabsCss]);\n  useImperativeHandle(apiRef, function () {\n    return {\n      openDialog: function openDialog() {\n        return widget.current.openDialog();\n      },\n      reloadInfo: function reloadInfo() {\n        return widget.current.reloadInfo();\n      },\n      getInput: function getInput() {\n        return widget.current.inputElement;\n      },\n      value: function value(_value) {\n        return widget.current.value(_value);\n      }\n    };\n  }, []);\n  return useCallback(function () {\n    return /*#__PURE__*/React.createElement(\"input\", {\n      type: \"hidden\",\n      ref: input,\n      id: id,\n      name: name\n    });\n  }, [id, name]);\n};\nvar Uploader = function Uploader(props) {\n  var Input = useWidget(props, uploadcare);\n  return /*#__PURE__*/React.createElement(Input, null);\n};\n\nexport { Uploader as default };\n"],"names":["useCommitedCallback","callback","ref","value","useRef","useEffect","current","useCommitedRef","useCallback","apply","arguments","useDeepEffect","effect","deps","undefined","useCustomTabs","tabs","uploadcare","Object","entries","forEach","_ref","_ref2","name","implementation","registerTab","_len","length","args","Array","_key","concat","defaultPreviewUrlCallback","cdnUrl","_excluded","useWidget","id","onFileSelect","onChange","onDialogOpen","onDialogClose","onTabChange","apiRef","customTabs","validators","tabsCss","locale","localeTranslations","localePluralize","previewUrlCallback","metadataCallback","options","_","input","widget","cachedValueRef","fileSelectedCallback","u","changeCallback","dialogOpenCallback","dialogCloseCallback","tabChangeCallback","metadataCommitedCallback","previewUrlCommitedCallback","d","widgetOptions","factory","isValid","valueRef","result","cache","useDeepMemo","window","UPLOADCARE_LOCALE","UPLOADCARE_LOCALE_PLURALIZE","UPLOADCARE_LOCALE_TRANSLATIONS","plugin","internal","rebuild","inputEl","Widget","metadata","widgetElement","nextSibling","jQuery","removeData","remove","instance","validator","push","useValidators","onUploadComplete","add","dialog","saveDialog","done","fail","progress","reject","files","saveFiles","file","cancel","indexOf","addUrl","addStyle","useImperativeHandle","openDialog","reloadInfo","getInput","inputElement","_value","type","Uploader","props","Input"],"sourceRoot":""}